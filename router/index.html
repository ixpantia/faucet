
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ixpantia.github.io/faucet/router/">
      
      
        <link rel="prev" href="../options/">
      
      
        <link rel="next" href="../in_containers/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.8">
    
    
      
        <title>Router Mode - faucet</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="faucet" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#faucet-router-mode" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="faucet" class="md-header__button md-logo" aria-label="faucet" data-md-component="logo">
      
  <img src="../figures/faucet.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            faucet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Router Mode
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../es/router/" hreflang="es" class="md-select__link">
              Espa√±ol
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ixpantia/faucet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="faucet" class="md-nav__button md-logo" aria-label="faucet" data-md-component="logo">
      
  <img src="../figures/faucet.png" alt="logo">

    </a>
    faucet
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ixpantia/faucet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Router Mode
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Router Mode
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#video-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Video Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activating-router-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Activating Router Mode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-file-froutertoml" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration File (frouter.toml)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration File (frouter.toml)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fields-explained" class="md-nav__link">
    <span class="md-ellipsis">
      Fields Explained:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routing-behavior-and-path-stripping" class="md-nav__link">
    <span class="md-ellipsis">
      Routing Behavior and Path Stripping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-froutertoml" class="md-nav__link">
    <span class="md-ellipsis">
      Example frouter.toml
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../in_containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    faucet in Containers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reverse_proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    With Reverse Proxy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../telemetry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telemetry
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#video-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Video Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activating-router-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Activating Router Mode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-file-froutertoml" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration File (frouter.toml)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration File (frouter.toml)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fields-explained" class="md-nav__link">
    <span class="md-ellipsis">
      Fields Explained:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routing-behavior-and-path-stripping" class="md-nav__link">
    <span class="md-ellipsis">
      Routing Behavior and Path Stripping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-froutertoml" class="md-nav__link">
    <span class="md-ellipsis">
      Example frouter.toml
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="faucet-router-mode">Faucet Router Mode</h1>
<p>Faucet's router mode allows you to serve multiple distinct applications from a single Faucet instance. Each application, or "route," can have its own configuration (like application type, working directory, number of workers, and load balancing strategy) and is accessible via a unique URL path prefix.</p>
<p>This is particularly useful for:</p>
<ul>
<li>Hosting multiple Shiny apps, Plumber APIs, or Quarto Shiny documents on the same server and port.</li>
<li>Deploying different versions or configurations of the same application under different paths.</li>
<li>Consolidating your R application deployments into a single Faucet process.</li>
</ul>
<h2 id="video-overview">Video Overview</h2>
<p>For a visual demonstration of the Faucet router feature, check out the following video:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/hQEdbrb2iTc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<h2 id="activating-router-mode">Activating Router Mode</h2>
<p>To run Faucet in router mode, you use the <code>router</code> subcommand:</p>
<pre><code class="language-bash">faucet router [OPTIONS]
</code></pre>
<p>The primary option for router mode is to specify the configuration file:</p>
<ul>
<li><strong>CLI:</strong> <code>--conf &lt;PATH_TO_CONFIG_FILE&gt;</code> or <code>-c &lt;PATH_TO_CONFIG_FILE&gt;</code></li>
<li><strong>Environment Variable:</strong> <code>FAUCET_ROUTER_CONF=&lt;PATH_TO_CONFIG_FILE&gt;</code></li>
<li><strong>Default:</strong> If not specified, Faucet will look for a file named <code>frouter.toml</code> in the current working directory (<code>./frouter.toml</code>).</li>
</ul>
<p>Global Faucet options such as <code>--host</code>, <code>--ip-from</code>, <code>--rscript</code>, <code>--quarto</code>, and telemetry settings (e.g., <code>--pg-con-string</code>) apply to the entire router instance and all routes it manages.</p>
<h2 id="configuration-file-froutertoml">Configuration File (<code>frouter.toml</code>)</h2>
<p>The router mode is configured using a TOML file. This file must define an array named <code>route</code>, where each element in the array is an object configuring a specific application route.</p>
<p>Here's the structure of a single route object within the <code>frouter.toml</code> file:</p>
<pre><code class="language-toml">[[route]]
# The URL path prefix for this application.
# This prefix MUST end with a trailing slash (e.g., &quot;/app/&quot;, &quot;/api/v1/&quot;).
# If it's the root path, it should be &quot;/&quot;.
# (Required)
route = &quot;/my_application/&quot;

# The type of application.
# (Required)
# Possible values: &quot;plumber&quot;, &quot;shiny&quot;, &quot;quarto-shiny&quot;
# Aliases like &quot;Plumber&quot;, &quot;Shiny&quot;, &quot;QuartoShiny&quot; are also accepted.
server_type = &quot;shiny&quot;

# The working directory for this specific application.
# Files like app.R or plumber.R will be looked for relative to this directory,
# or within the `app_dir` if specified. Paths can be relative (to where frouter.toml is) or absolute.
# (Optional, defaults to &quot;.&quot; - the directory where frouter.toml is located)
workdir = &quot;./apps/my_shiny_app&quot;

# The subdirectory within `workdir` where the application's main file (e.g., app.R) is located.
# If your app.R is directly in `workdir`, you can omit this or set it to &quot;.&quot;.
# (Optional)
app_dir = &quot;source&quot; # Looks for ./apps/my_shiny_app/source/app.R

# The number of worker processes to spawn for this application.
# (Required)
workers = 2

# The load balancing strategy for this application.
# (Optional, defaults depend on application type: &quot;ip-hash&quot; for shiny/quarto-shiny, &quot;round-robin&quot; for plumber)
# Possible values: &quot;round-robin&quot;, &quot;ip-hash&quot;, &quot;cookie-hash&quot;
strategy = &quot;ip-hash&quot;

# Path to the Quarto document (.qmd file), required if server_type is &quot;quarto-shiny&quot;.
# The path should be relative to `workdir` or an absolute path.
# (Optional, but required for quarto-shiny)
# qmd = &quot;dashboard.qmd&quot;
</code></pre>
<h3 id="fields-explained">Fields Explained:</h3>
<ul>
<li><code>route</code> (String, Required): The URL path prefix. <strong>This prefix must end with a trailing slash (e.g., <code>/app/</code>, <code>/api/v1/</code>) unless it is the root route (<code>/</code>)</strong>. Faucet will direct requests starting with this path to the configured application.</li>
<li><code>server_type</code> (String, Required): Determines the type of R application. Must be one of <code>plumber</code>, <code>shiny</code>, or <code>quarto-shiny</code>. Aliases like <code>Plumber</code>, <code>Shiny</code>, <code>QuartoShiny</code> are also accepted.</li>
<li><code>workdir</code> (String, Optional): The base working directory for the application. If not specified, it defaults to the directory where Faucet is running (typically where <code>frouter.toml</code> is located). Paths for <code>app_dir</code> and <code>qmd</code> are typically resolved relative to this.</li>
<li><code>app_dir</code> (String, Optional): A subdirectory within <code>workdir</code> that contains the application's main file (e.g., <code>app.R</code> for Shiny, <code>plumber.R</code> for Plumber). For example, if <code>workdir = "./my_app_collection"</code> and <code>app_dir = "specific_app_src"</code>, Faucet will look for <code>./my_app_collection/specific_app_src/app.R</code>. If the main file is directly in <code>workdir</code>, you can omit this or use <code>app_dir = "."</code>.</li>
<li><code>workers</code> (Integer, Required): The number of R worker processes to launch for this specific route. Must be a positive integer.</li>
<li><code>strategy</code> (String, Optional): The load balancing strategy for this route.<ul>
<li>For <code>shiny</code> and <code>quarto-shiny</code> apps, <code>ip-hash</code> is generally recommended and is the default to ensure session persistence.</li>
<li>For <code>plumber</code> APIs, <code>round-robin</code> is the default.</li>
<li>Available options: <code>round-robin</code>, <code>ip-hash</code>, <code>cookie-hash</code>.</li>
</ul>
</li>
<li><code>qmd</code> (String, Optional): If <code>server_type</code> is <code>quarto-shiny</code>, this field is required and must specify the path to the <code>.qmd</code> file. This path is typically relative to <code>workdir</code>.</li>
</ul>
<p><strong>Important:</strong> Each <code>route</code> value in the configuration file must be unique. Duplicate routes will cause Faucet to exit with an error on startup.</p>
<h2 id="routing-behavior-and-path-stripping">Routing Behavior and Path Stripping</h2>
<p>When Faucet receives an HTTP request in router mode:</p>
<ol>
<li>It iterates through the <code>[[route]]</code> definitions in <code>frouter.toml</code> <strong>in the order they are defined.</strong></li>
<li><strong>Route Matching and Order:</strong><ul>
<li>For each defined route, Faucet checks if the incoming request's URL path starts with the route's <code>route</code> prefix.</li>
<li><strong>The first route that matches is used.</strong> This means the order of your routes in <code>frouter.toml</code> is critical. More specific routes (e.g., <code>/app/feature1/</code>) must be listed <em>before</em> more general routes (e.g., <code>/app/</code>) if they share a common base path, to prevent the general route from "shadowing" the specific one. The root route <code>/</code> should generally be listed last.</li>
</ul>
</li>
<li><strong>Path Stripping:</strong><ul>
<li>All <code>route</code> prefixes (except for the root route <code>/</code>) <strong>must end with a trailing slash (<code>/</code>)</strong>.</li>
<li>Once a matching route is found, its defined <code>route</code> prefix is stripped from the beginning of the request's URL path.</li>
<li>The remaining part of the path is then forwarded to the application configured for that route.</li>
<li>Example: If <code>route = "/myapp/"</code> is defined:<ul>
<li>A request to <code>/myapp/users/1</code> results in the application seeing <code>/users/1</code>.</li>
<li>A request to <code>/myapp/</code> (with the trailing slash) results in the application seeing <code>/</code>.</li>
</ul>
</li>
<li>Example: If <code>route = "/"</code> is defined:<ul>
<li>A request to <code>/page</code> results in the application seeing <code>/page</code>.</li>
<li>A request to <code>/</code> results in the application seeing <code>/</code>.</li>
</ul>
</li>
</ul>
</li>
<li>If a matching route is found, the request (with the potentially modified path) is handed over to the Faucet server instance managing that specific application, which then applies its configured load balancing strategy to select a worker.</li>
<li>If no configured <code>route</code> matches the incoming request's path, Faucet returns a <code>404 Not Found</code> response.</li>
</ol>
<h2 id="example-froutertoml">Example <code>frouter.toml</code></h2>
<p>This example is based on the <code>faucet-router-example</code> available in the Faucet GitHub repository under the <code>examples/</code> directory. To run this example, navigate to <code>examples/faucet-router-example-main/</code> and run <code>faucet router</code>.</p>
<pre><code class="language-toml"># frouter.toml
# This file is located in examples/faucet-router-example-main/

# Route for the &quot;sliders&quot; Shiny application.
# `workdir` is set to &quot;./sliders&quot;, so Faucet looks for app.R
# in examples/faucet-router-example-main/sliders/app.R
[[route]]
route = &quot;/sliders/&quot;
workers = 1
server_type = &quot;shiny&quot; # Note: &quot;Shiny&quot; (capitalized) is also accepted
workdir = &quot;./sliders&quot;

# Route for the &quot;text&quot; Shiny application.
# `workdir` defaults to &quot;.&quot; (where frouter.toml is).
# `app_dir` is &quot;./text&quot;, so Faucet looks for app.R
# in examples/faucet-router-example-main/text/app.R
[[route]]
route = &quot;/text/&quot;
workers = 1
server_type = &quot;shiny&quot;
app_dir = &quot;./text&quot;

# Route for a Quarto Shiny document.
# `workdir` is &quot;./qmd&quot;.
# `qmd` specifies &quot;old_faithful.qmd&quot; relative to workdir.
# Faucet looks for examples/faucet-router-example-main/qmd/old_faithful.qmd
[[route]]
route = &quot;/qmd/&quot;
workers = 1
server_type = &quot;quarto-shiny&quot; # Note: &quot;QuartoShiny&quot; (capitalized) is also accepted
workdir = &quot;./qmd&quot;
qmd = &quot;old_faithful.qmd&quot;

# Route for a Plumber API.
# `workdir` is &quot;./api&quot;. Faucet looks for plumber.R
# in examples/faucet-router-example-main/api/plumber.R
[[route]]
route = &quot;/api/&quot;
workers = 1
server_type = &quot;plumber&quot; # Note: &quot;Plumber&quot; (capitalized) is also accepted
workdir = &quot;./api&quot;
strategy = &quot;round-robin&quot;

# Root route for the main Shiny application.
# `workdir` defaults to &quot;.&quot; (where frouter.toml is).
# Faucet looks for app.R in examples/faucet-router-example-main/app.R
# This route is placed last to avoid shadowing other specific routes.
[[route]]
route = &quot;/&quot;
workers = 1
server_type = &quot;shiny&quot;
strategy = &quot;cookie-hash&quot;
</code></pre>
<p>With the configuration above, if Faucet is running on <code>http://localhost:3838</code> from the <code>examples/faucet-router-example-main/</code> directory:</p>
<ul>
<li>Requests to <code>http://localhost:3838/sliders/</code> would be routed to the Shiny app in the <code>sliders</code> subdirectory.</li>
<li>Requests to <code>http://localhost:3838/text/</code> would be routed to the Shiny app in the <code>text</code> subdirectory.</li>
<li>Requests to <code>http://localhost:3838/qmd/</code> would be routed to the <code>old_faithful.qmd</code> Quarto Shiny document.</li>
<li>Requests to <code>http://localhost:3838/api/echo?msg=hello</code> would be routed to the Plumber API in the <code>api</code> subdirectory (the API would see <code>/echo?msg=hello</code>).</li>
<li>Requests to <code>http://localhost:3838/</code> would be routed to the <code>app.R</code> in the root of the <code>faucet-router-example-main</code> directory.</li>
</ul>
<p><strong>Note on Route Order:</strong> Remember that if you have routes with overlapping base paths (e.g., <code>/data/specific/</code> and <code>/data/</code>), you must list the more specific route (<code>/data/specific/</code>) <em>before</em> the more general route (<code>/data/</code>) in your <code>frouter.toml</code> file. Otherwise, the general route <code>/data/</code> would match requests intended for <code>/data/specific/</code>, and the specific route would never be reached. The root route <code>/</code> should typically be the last entry.</p>
<p>This router mode provides a flexible way to manage and serve multiple R applications efficiently using a single Faucet instance.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>