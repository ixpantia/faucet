
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ixpantia.github.io/faucet/in_containers/">
      
      
        <link rel="prev" href="../router/">
      
      
        <link rel="next" href="../logging/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.8">
    
    
      
        <title>faucet in Containers - faucet</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="faucet" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#faucet-in-containers-docker" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="faucet" class="md-header__button md-logo" aria-label="faucet" data-md-component="logo">
      
  <img src="../figures/faucet.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            faucet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              faucet in Containers
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../es/in_containers/" hreflang="es" class="md-select__link">
              Espa√±ol
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ixpantia/faucet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="faucet" class="md-nav__button md-logo" aria-label="faucet" data-md-component="logo">
      
  <img src="../figures/faucet.png" alt="logo">

    </a>
    faucet
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ixpantia/faucet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Router Mode
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    faucet in Containers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    faucet in Containers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#build-a-docker-image-for-faucet" class="md-nav__link">
    <span class="md-ellipsis">
      Build a Docker Image for faucet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Build a Docker Image for faucet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-basic-shiny-app-or-plumber-api" class="md-nav__link">
    <span class="md-ellipsis">
      A basic Shiny app or Plumber API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A basic Shiny app or Plumber API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shiny-app" class="md-nav__link">
    <span class="md-ellipsis">
      Shiny app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plumber-api" class="md-nav__link">
    <span class="md-ellipsis">
      Plumber API
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dockerignore" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerignore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-the-dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Writing the Dockerfile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-the-docker-image" class="md-nav__link">
    <span class="md-ellipsis">
      Building the Docker image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-the-docker-image" class="md-nav__link">
    <span class="md-ellipsis">
      Running the Docker image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-the-faucet-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling the faucet instance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reverse_proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    With Reverse Proxy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../telemetry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telemetry
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#build-a-docker-image-for-faucet" class="md-nav__link">
    <span class="md-ellipsis">
      Build a Docker Image for faucet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Build a Docker Image for faucet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-basic-shiny-app-or-plumber-api" class="md-nav__link">
    <span class="md-ellipsis">
      A basic Shiny app or Plumber API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A basic Shiny app or Plumber API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shiny-app" class="md-nav__link">
    <span class="md-ellipsis">
      Shiny app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plumber-api" class="md-nav__link">
    <span class="md-ellipsis">
      Plumber API
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dockerignore" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerignore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-the-dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Writing the Dockerfile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-the-docker-image" class="md-nav__link">
    <span class="md-ellipsis">
      Building the Docker image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-the-docker-image" class="md-nav__link">
    <span class="md-ellipsis">
      Running the Docker image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-the-faucet-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling the faucet instance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="faucet-in-containers-docker">faucet in Containers (Docker)</h1>
<p>Probably the easiest and most versatile way to deploy faucet
is to build a Linux container image and run it in a container.
This will allow you to run faucet on any Linux host that supports
containers, like a laptop, a VM, or a server.</p>
<h2 id="build-a-docker-image-for-faucet">Build a Docker Image for faucet</h2>
<p>In this section, you will be using the available faucet + R image
from the Docker Hub. You can however, build your own image if you
want to. You should use the available installation instructions
for your OS to install Docker.</p>
<p>In order to properly build the faucet image, you will need to
take the following steps into account:</p>
<ol>
<li><em>Install Docker on your host machine.</em> You can find instructions
   on how to do this for your specific OS in the
   <a href="https://docs.docker.com/engine/install/">Docker Installation Guide</a>.</li>
<li><em>Take your R application dependencies into account.</em> If you are
   using R packages that require system dependencies, you will
   need to install them in the Docker image. Also, take the R
   and library versions into account, we highly recommend you
   use <a href="https://rstudio.github.io/renv/articles/renv.html">renv</a>.
   For this tutorial we will assume you are using <code>renv</code> already.</li>
<li><em>Ignore sensitive or unnecessary files.</em> You can use a <code>.dockerignore</code>
   file to ignore files that are not needed in the Docker image or
   you can manually specify the files you want to include in the
   image. In this case, we will use a <code>.dockerignore</code> file to ignore
   said files.</li>
</ol>
<h3 id="a-basic-shiny-app-or-plumber-api">A basic Shiny app or Plumber API</h3>
<p>In this section, you will bootstrap a basic Shiny app or Plumber API
to use as an example. You can use your own app or API, but make sure
you have <code>renv</code> initialized.</p>
<h4 id="shiny-app">Shiny app</h4>
<pre><code class="language-r"># app.R
library(shiny)

ui &lt;- fluidPage(
  titlePanel(&quot;Hello Shiny!&quot;),
  sidebarLayout(
    sidebarPanel(
      sliderInput(&quot;obs&quot;, &quot;Number of observations:&quot;, min = 10, max = 500, value = 100)
    ),
    mainPanel(
      plotOutput(&quot;distPlot&quot;)
    )
  )
)

server &lt;- function(input, output) {
  output$distPlot &lt;- renderPlot({
    hist(rnorm(input$obs))
  })
}

shinyApp(ui = ui, server = server)
</code></pre>
<p>After saving the app, you can run it locally with:</p>
<pre><code class="language-r">shiny::runApp()
</code></pre>
<p>To make absolutely sure that <code>renv</code> detects all the packages used
in the app, you should create a <code>dependencies.R</code> file with the
following contents:</p>
<pre><code class="language-r"># dependencies.R
library(shiny)
</code></pre>
<p>Now, you can initialize <code>renv</code> and install the packages:</p>
<pre><code class="language-r">renv::init()
renv::activate()
</code></pre>
<h4 id="plumber-api">Plumber API</h4>
<pre><code class="language-r"># plumber.R
#* @get /echo
function(){
  list(msg = &quot;Hello World!&quot;)
}
</code></pre>
<p>After saving the API, you can run it locally with:</p>
<pre><code class="language-r">library(plumber)
# 'plumber.R' is the location of the file shown above
pr(&quot;plumber.R&quot;) %&gt;%
  pr_run()
</code></pre>
<p>To make absolutely sure that <code>renv</code> detects all the packages used
in the API, you should create a <code>dependencies.R</code> file with the
following contents:</p>
<pre><code class="language-r"># dependencies.R
library(plumber)
</code></pre>
<p>Now, you can initialize <code>renv</code> and install the packages:</p>
<pre><code class="language-r">renv::init()
renv::activate()
</code></pre>
<h3 id="dockerfile">Dockerfile</h3>
<h4 id="dockerignore">Dockerignore</h4>
<p>The first step to building our Docker image is to create a <code>.dockerignore</code>
file in the root of our project. This file will contain the files
that you want to ignore when building the Docker image. In this case,
we will ignore the following <code>renv</code> files:</p>
<pre><code class="language-dockerignore">renv/library/
renv/local/
renv/cellar/
renv/lock/
renv/python/
renv/sandbox/
renv/staging/
</code></pre>
<p>If this were a real project, you would probably also ignore files
like <code>.git</code>, <code>.Rproj.user</code>, <code>.DS_Store</code>, and sensitive files like
<code>.env</code>, <code>.htpasswd</code>, etc.</p>
<h4 id="writing-the-dockerfile">Writing the Dockerfile</h4>
<p>The first step to building our Docker image is to create a <code>Dockerfile</code>
in the root of our project. This file will contain the instructions
to build our Docker image. In this case, you will use the
<a href="https://hub.docker.com/r/ixpantia/faucet"><code>ixpantia/faucet</code></a>
image as our base image. This image is based on the
<a href="https://hub.docker.com/r/rocker/r-ver"><code>rocker/r-ver</code></a> image,
which is a minimal R image based on Debian Linux.</p>
<pre><code>FROM ixpantia/faucet:r4.3

# Some environment variables to tell `renv`
# to install packages in the correct location
# and without unnecessary symlinks
ENV RENV_CONFIG_CACHE_SYMLINKS FALSE
ENV RENV_PATHS_LIBRARY /srv/faucet/renv/library

# You copy the necessary files to bootstrap `renv`
COPY ./renv.lock .
COPY ./renv ./renv
COPY ./.Rprofile .

# You install the packages
RUN Rscript -e &quot;renv::restore()&quot;

# Copy the app/API files in this case replace
# `app.R` with `plumber.R` if you are using a
# Plumber API
COPY ./app.R .

# You can run the container as a non-root user
# for security reasons if we want to though
# this is not necessary. You could ignore this
RUN chown -R faucet:faucet /srv/faucet/
USER faucet
</code></pre>
<h4 id="building-the-docker-image">Building the Docker image</h4>
<p>Now that you have a <code>Dockerfile</code> and a <code>.dockerignore</code> file, you
can build the Docker image with the following command:</p>
<pre><code class="language-bash">docker build -t my_faucet_app .
</code></pre>
<h4 id="running-the-docker-image">Running the Docker image</h4>
<p>Once the image is built, you can run it with the following command:</p>
<pre><code class="language-bash">docker run --rm -p 3838:3838 my_faucet_app
</code></pre>
<p>You can now access your app/API at <code>http://localhost:3838</code>.</p>
<h4 id="controlling-the-faucet-instance">Controlling the faucet instance</h4>
<p>You can control every aspect of the faucet instance by setting
environment variables in the Docker container. For example, if
you want to change the number of workers, you can do so by setting
the <code>FAUCET_WORKERS</code> environment variable:</p>
<pre><code class="language-bash">docker run --rm -p 3838:3838 -e FAUCET_WORKERS=4 my_faucet_app
</code></pre>
<p>If you are running the app/API behind a proxy like Nginx, you
can set the <code>FAUCET_IP_FROM</code> environment variable to <code>x-real-ip</code>
or <code>x-forwarded-for</code> to make sure faucet gets the correct IP
address of the client.</p>
<pre><code class="language-bash">docker run --rm -p 3838:3838 -e FAUCET_IP_FROM=x-real-ip my_faucet_app
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>